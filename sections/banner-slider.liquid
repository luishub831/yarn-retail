<div class="section_banner-slider padding-global">
  <div class="swiper mySwiper-{{ section.id }}">
    <div class="swiper-wrapper">
      {% for block in section.blocks %}
        <div class="swiper-slide{% if section.settings.transition_style == 'seamless' %} seamless-slide{% endif %}">
          <div class="banner-slide-content">
            {% if block.settings.image %}
              <!-- Desktop Image -->
              <img 
                src="{{ block.settings.image | img_url: 'master' }}" 
                alt="{{ block.settings.heading | escape }}" 
                class="banner-slide-image desktop-image"
              />
            {% endif %}
            
            {% if block.settings.mobile_image %}
              <!-- Mobile Image -->
              <img 
                src="{{ block.settings.mobile_image | img_url: 'master' }}" 
                alt="{{ block.settings.heading | escape }}" 
                class="banner-slide-image mobile-image"
              />
            {% endif %}

            <div class="banner-content-wrapper" 
                 data-desktop-position="{{ block.settings.desktop_position }}" 
                 data-desktop-alignment="{{ block.settings.desktop_alignment }}"
                 data-mobile-position="{{ block.settings.mobile_position }}"
                 data-mobile-alignment="{{ block.settings.mobile_alignment }}"
                 style="--desktop-width: {{ block.settings.desktop_width }}px; --desktop-spacing: {{ block.settings.desktop_spacing }}px;">
              <div class="banner-text">
                {% if block.settings.heading != blank %}
                  <h1 class="banner-heading">{{ block.settings.heading }}</h1>
                {% endif %}
                {% if block.settings.description != blank %}
                  <p class="banner-description">{{ block.settings.description }}</p>
                {% endif %}
                {% if block.settings.button_text != blank %}
                  <a href="{{ block.settings.button_link }}" class="button w-inline-block is-default is-primary banner-button">
                    <span>{{ block.settings.button_text }}</span>
                  </a>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    <!-- arrows + dots -->
    <div class="swiper-button-next swiper-button-next-{{ section.id }}"></div>
    <div class="swiper-button-prev swiper-button-prev-{{ section.id }}"></div>
    <div class="swiper-pagination swiper-pagination-{{ section.id }}"></div>
  </div>
</div>

{% schema %}
{
  "name": "Banner Slider",
  "settings": [
    {
      "type": "select",
      "id": "transition_style",
      "label": "Transition style",
      "default": "fade",
      "options": [
        { "value": "fade", "label": "Fade" },
        { "value": "slide", "label": "Swipe" },
        { "value": "seamless", "label": "Seamless" }
      ],
      "info": "With seamless mode slides appear as one smooth line when you drag them"
    },
    {
      "type": "checkbox",
      "id": "autoplay_enabled",
      "label": "Enable autoplay",
      "default": false
    },
    {
      "type": "range",
      "id": "autoplay_interval",
      "label": "Autoplay interval",
      "min": 1,
      "max": 30,
      "step": 1,
      "default": 10,
      "unit": "s"
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Desktop Image" },
        { "type": "image_picker", "id": "mobile_image", "label": "Mobile Image" },
        { "type": "text", "id": "heading", "label": "Heading" },
        { "type": "textarea", "id": "description", "label": "Description" },
        { "type": "text", "id": "button_text", "label": "Button Text" },
        { "type": "url", "id": "button_link", "label": "Button Link" },
        {
          "type": "header",
          "content": "Content position"
        },
        {
          "type": "select",
          "id": "desktop_position",
          "label": "Desktop position",
          "default": "center_left",
          "options": [
            { "value": "top_left", "label": "Top left" },
            { "value": "top_center", "label": "Top center" },
            { "value": "top_right", "label": "Top right" },
            { "value": "center_left", "label": "Center left" },
            { "value": "center", "label": "Center" },
            { "value": "center_right", "label": "Center right" },
            { "value": "bottom_left", "label": "Bottom left" },
            { "value": "bottom_center", "label": "Bottom center" },
            { "value": "bottom_right", "label": "Bottom right" }
          ]
        },
        {
          "type": "select",
          "id": "desktop_alignment",
          "label": "Desktop alignment",
          "default": "left",
          "options": [
            { "value": "left", "label": "Left" },
            { "value": "center", "label": "Center" }
          ]
        },
        {
          "type": "range",
          "id": "desktop_width",
          "label": "Desktop width",
          "min": 300,
          "max": 1200,
          "step": 10,
          "default": 600,
          "unit": "px"
        },
        {
          "type": "range",
          "id": "desktop_spacing",
          "label": "Desktop spacing",
          "info": "Adjust the spacing between the section borders and content",
          "min": 0,
          "max": 100,
          "step": 4,
          "default": 80,
          "unit": "px"
        },
        {
          "type": "select",
          "id": "mobile_position",
          "label": "Mobile position",
          "default": "top",
          "options": [
            { "value": "top", "label": "Top" },
            { "value": "center", "label": "Center" },
            { "value": "bottom", "label": "Bottom" }
          ]
        },
        {
          "type": "select",
          "id": "mobile_alignment",
          "label": "Mobile alignment",
          "default": "left",
          "options": [
            { "value": "left", "label": "Left" },
            { "value": "center", "label": "Center" }
          ]
        }
      ]
    }
  ],
  "presets": [{ "name": "Banner Slider" }]
}
{% endschema %}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js" defer></script>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    // Use transition style from section settings
    var transition = "{{ section.settings.transition_style | default: 'slide' }}";
    var sectionId = "{{ section.id }}";
    var swiperSelector = ".mySwiper-" + sectionId;
    var autoplayEnabled = {{ section.settings.autoplay_enabled | default: false | json }};
    var autoplayInterval = ({{ section.settings.autoplay_interval | default: 10 }} || 10) * 1000;
    var swiperOptions = {
      loop: true,
      slidesPerView: 1,
      spaceBetween: 0,
      navigation: {
        nextEl: ".swiper-button-next-" + sectionId,
        prevEl: ".swiper-button-prev-" + sectionId,
      },
      pagination: {
        el: ".swiper-pagination-" + sectionId,
        clickable: true,
      }
    };
    if (autoplayEnabled) {
      swiperOptions.autoplay = {
        delay: autoplayInterval,
        disableOnInteraction: false
      };
    }
    if (transition === 'fade') {
      swiperOptions.effect = 'fade';
      swiperOptions.fadeEffect = { crossFade: true };
    } else if (transition === 'seamless') {
      swiperOptions.freeMode = true;
      swiperOptions.loop = true;
      swiperOptions.slidesPerView = 'auto';
      swiperOptions.spaceBetween = 0;
    }
    new Swiper(swiperSelector, swiperOptions);
  
  });
</script>

<style>
/* ---------- Desktop styles (unchanged) ---------- */
.banner-slide-content {
  position: relative;
  height: 66vh;
  overflow: hidden;
  display: flex;
  align-items: stretch;
}

.banner-slide-image {
  width: 100%;
  height: 100%;
  object-fit: contain;
  display: block;
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1;
  background: transparent;
  border-radius: 20px;
}

/* Default: show desktop image, hide mobile */
.desktop-image { display: block; }
.mobile-image { display: none; }

.banner-content-wrapper {
  position: relative;
  z-index: 2;
  width: 100%;
  max-width: 1700px;
  margin: 0 auto;
  padding: 0 var(--desktop-spacing, 80px);
  display: flex;
}

/* Desktop Position - Vertical */
.banner-content-wrapper[data-desktop-position^="top"] { align-items: flex-start; }
.banner-content-wrapper[data-desktop-position^="center"] { align-items: center; }
.banner-content-wrapper[data-desktop-position^="bottom"] { align-items: flex-end; }

/* Desktop Position - Horizontal */
.banner-content-wrapper[data-desktop-position$="_left"] { justify-content: flex-start; }
.banner-content-wrapper[data-desktop-position$="_center"],
.banner-content-wrapper[data-desktop-position="center"] { justify-content: center; }
.banner-content-wrapper[data-desktop-position$="_right"] { justify-content: flex-end; }

.banner-text {
  max-width: var(--desktop-width, 600px);
  color: #fff;
  margin: 40px;
}

/* Desktop Alignment */
.banner-content-wrapper[data-desktop-alignment="left"] .banner-text { text-align: left; }
.banner-content-wrapper[data-desktop-alignment="center"] .banner-text { text-align: center; }

.banner-heading {
  font-family: 'Newake', sans-serif;
  font-size: clamp(3rem, 6vw, 60px);
  font-weight: 400;
  line-height: 60px;
  letter-spacing: 0%;
  vertical-align: middle;
  margin-bottom: 1rem;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
  text-transform: inherit;
}

.banner-description {
  font-size: 1.2rem;
  line-height: 1.6;
  margin-bottom: 2rem;
  opacity: 0.95;
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
}

.banner-button {
  margin-top: 1rem;
  width: auto !important;
  display: inline-block !important;
  max-width: none !important;
}

/* Swiper controls */
.swiper-button-next, .swiper-button-prev {
  color: white;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  backdrop-filter: blur(10px);
}

.swiper-pagination-bullet {
  background: rgba(255, 255, 255, 0.7);
}

.swiper-pagination-bullet-active {
  background: #ff6b35;
}


/* ---------- Mobile adjustments ---------- */
@media (max-width: 768px) {
  .banner-slide-content {
    height: 80vh;
  }

  /* Swap images */
  .desktop-image { display: none; }
  .mobile-image { display: block; object-fit: cover;}

  .banner-slide-content{
    align-items: stretch;
  }
  
  .banner-content-wrapper {
    padding: 40px 30px;
  }

  /* Mobile Position */
  .banner-content-wrapper[data-mobile-position="top"] { align-items: flex-start; }
  .banner-content-wrapper[data-mobile-position="center"] { align-items: center; }
  .banner-content-wrapper[data-mobile-position="bottom"] { align-items: flex-end; }

  /* Mobile Alignment */
  .banner-content-wrapper[data-mobile-alignment="left"] .banner-text { text-align: left; }
  .banner-content-wrapper[data-mobile-alignment="center"] .banner-text { text-align: center; }

  .banner-heading {
    font-size: clamp(2rem, 6vw, 3rem);
    margin-bottom: 0.8rem;
    line-height: 40px;
  }

  .banner-description {
    font-size: 1rem;
    margin-bottom: 1.5rem;
  }

  .banner-button {
    padding: 12px 24px;
    font-size: 0.9rem;
    width: 100% !important;
    text-align: center;
  }
  
}
</style>
